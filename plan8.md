# üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: YandexGPTProvider

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: 100%** ‚úÖ (12/12 —à–∞–≥–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ)

---

## –ó–∞–¥–∞—á–∏:

### ‚úÖ –®–∞–≥ 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ProviderConfig –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ folder_id

- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `folder_id: str | None` –≤ `ProviderConfig` (base.py)
  - –û–ø–∏—Å–∞–Ω–∏–µ: "Yandex Cloud folder ID (required for YandexGPT)"
  - Default: `None`
  - –û–±–Ω–æ–≤–∏—Ç—å docstring —Å –ø—Ä–∏–º–µ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è YandexGPT

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 1/1**

---

### ‚úÖ –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ yandexgpt.py

- ‚úÖ –°–æ–∑–¥–∞—Ç—å `src/orchestrator/providers/yandexgpt.py`
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å imports (httpx, base exceptions, typing)
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
  - `DEFAULT_BASE_URL = "https://llm.api.cloud.yandex.net"`
  - `DEFAULT_MODEL = "yandexgpt/latest"`
  - `API_ENDPOINT = "/foundationModels/v1/completion"`

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 3/3**

---

### ‚úÖ –®–∞–≥ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ YandexGPTProvider

- ‚úÖ –ù–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç `BaseProvider`
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `__init__(self, config: ProviderConfig)`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `api_key` –∏ `folder_id`
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `httpx.AsyncClient` —Å `config.timeout`
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `_build_model_uri(self) -> str`
  - –ï—Å–ª–∏ `config.model` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `"gpt://"` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –µ—Å—Ç—å
  - –ò–Ω–∞—á–µ: `f"gpt://{self.config.folder_id}/{self.config.model or self.DEFAULT_MODEL}"`

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 3/3**

---

### ‚úÖ –®–∞–≥ 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ generate()

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `async def generate(prompt, params) -> str`
  - –ü–æ—Å—Ç—Ä–æ–∏—Ç—å `model_uri` —á–µ—Ä–µ–∑ `_build_model_uri()`
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å headers:
    - `Authorization: Bearer {api_key}`
    - `x-folder-id: {folder_id}`
    - `Content-Type: application/json`
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å payload:
    - `modelUri`: model_uri
    - `completionOptions`: `{stream: False, temperature, maxTokens}`
    - `messages`: `[{role: "user", text: prompt}]`
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å POST –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ `httpx.AsyncClient`
  - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–≤–µ—Ç: –∏–∑–≤–ª–µ—á—å `response["result"]["alternatives"][0]["message"]["text"]`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
  - `httpx.TimeoutException` ‚Üí `TimeoutError`
  - `httpx.ConnectError`, `httpx.NetworkError` ‚Üí `ProviderError`
  - HTTP –æ—à–∏–±–∫–∏ ‚Üí —á–µ—Ä–µ–∑ `_handle_error()`

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 2/2**

---

### ‚úÖ –®–∞–≥ 5: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ _handle_error()

- ‚úÖ –°–æ–∑–¥–∞—Ç—å `_handle_error(self, response: httpx.Response) -> None`
  - –ò–∑–≤–ª–µ—á—å error message –∏–∑ JSON (–ø–æ–ª–µ `message`) –∏–ª–∏ response.text
  - –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤:
    - `400` ‚Üí `InvalidRequestError`
    - `401` ‚Üí `AuthenticationError` ("Invalid or expired IAM token")
    - `403` ‚Üí `AuthenticationError` ("Access denied (check folder_id and permissions)")
    - `404` ‚Üí `InvalidRequestError` ("Model not found")
    - `429` ‚Üí `RateLimitError`
    - `500+` ‚Üí `ProviderError`
  - –í—ã–±—Ä–æ—Å–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 1/1**

---

### ‚úÖ –®–∞–≥ 6: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ health_check()

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `async def health_check(self) -> bool`
  - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π timeout
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π timeout (5 —Å–µ–∫—É–Ω–¥)
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
    - URL: `{base_url}/foundationModels/v1/completion`
    - Headers: Authorization, x-folder-id, Content-Type
    - Payload: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (modelUri, completionOptions: {maxTokens: 10}, messages: [{role: "user", text: "Hi"}])
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `response.status_code == 200`
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π timeout
  - –í–µ—Ä–Ω—É—Ç—å `True` –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, `False` –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 1/1**

---

### ‚úÖ –®–∞–≥ 7: –û–±—Ä–∞–±–æ—Ç–∫–∞ GenerationParams

- ‚úÖ –í –º–µ—Ç–æ–¥–µ `generate()`:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `params.temperature` (default: 0.6 –µ—Å–ª–∏ None)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `params.max_tokens` (default: 1000 –µ—Å–ª–∏ None)
  - **–ù–ï** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `top_p` –∏ `stop` (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è API)

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 1/1**

---

### ‚úÖ –®–∞–≥ 8: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

- ‚úÖ –°–æ–∑–¥–∞—Ç—å `tests/test_yandexgpt_provider.py`
- ‚úÖ –¢–µ—Å—Ç: —É—Å–ø–µ—à–Ω—ã–π generate (mock response)
- ‚úÖ –¢–µ—Å—Ç: generate —Å GenerationParams (temperature, max_tokens)
- ‚úÖ –¢–µ—Å—Ç: generate —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–æ–¥–µ–ª—å—é (yandexgpt-lite)
- ‚úÖ –¢–µ—Å—Ç: generate —Å –ø–æ–ª–Ω—ã–º URI (gpt://...)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 400 (InvalidRequestError)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 401 (AuthenticationError)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 403 (AuthenticationError)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 404 (InvalidRequestError)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 429 (RateLimitError)
- ‚úÖ –¢–µ—Å—Ç: –æ—à–∏–±–∫–∞ 500 (ProviderError)
- ‚úÖ –¢–µ—Å—Ç: timeout error (TimeoutError)
- ‚úÖ –¢–µ—Å—Ç: connection error (ProviderError)
- ‚úÖ –¢–µ—Å—Ç: network error (ProviderError)
- ‚úÖ –¢–µ—Å—Ç: health_check —É—Å–ø–µ—à–Ω—ã–π
- ‚úÖ –¢–µ—Å—Ç: health_check –Ω–µ—É—Å–ø–µ—à–Ω—ã–π (401)
- ‚úÖ –¢–µ—Å—Ç: –≤–∞–ª–∏–¥–∞—Ü–∏—è config (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ api_key)
- ‚úÖ –¢–µ—Å—Ç: –≤–∞–ª–∏–¥–∞—Ü–∏—è config (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ folder_id)
- ‚úÖ –¢–µ—Å—Ç: —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ modelUri (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ)
- ‚úÖ –¢–µ—Å—Ç: —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ modelUri (default model)
- ‚úÖ –¢–µ—Å—Ç: —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ modelUri (–ø–æ–ª–Ω—ã–π URI –≤ config.model)
- ‚úÖ –¢–µ—Å—Ç: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –æ—Ç–≤–µ—Ç–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON)
- ‚úÖ –¢–µ—Å—Ç: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ JSON
- ‚úÖ –¢–µ—Å—Ç: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 24/24** (–¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã)

---

### ‚úÖ –®–∞–≥ 9: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ __init__.py

- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `from .yandexgpt import YandexGPTProvider` –≤ `providers/__init__.py`
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `"YandexGPTProvider"` –≤ `__all__`

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 2/2**

---

### ‚úÖ –®–∞–≥ 10: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å README.md:
  - –î–æ–±–∞–≤–∏—Ç—å YandexGPTProvider –≤ —Å–µ–∫—Ü–∏—é "Supported Providers"
  - –î–æ–±–∞–≤–∏—Ç—å Quick Start –ø—Ä–∏–º–µ—Ä –¥–ª—è YandexGPT
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å env.example:
  - –î–æ–±–∞–≤–∏—Ç—å `YANDEXGPT_FOLDER_ID=your_folder_id_here`
  - –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è YANDEXGPT_API_KEY (IAM token)

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 2/2**

---

### ‚úÖ –®–∞–≥ 11: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- ‚úÖ –°–æ–∑–¥–∞—Ç—å `examples/yandexgpt_demo.py`
  - –ò–º–ø–æ—Ä—Ç—ã: Router, ProviderConfig, YandexGPTProvider
  - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
  - –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å Router
  - –ü—Ä–∏–º–µ—Ä —Å GenerationParams
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 1/1**

---

### ‚úÖ –®–∞–≥ 12: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `mypy --strict` (0 –æ—à–∏–±–æ–∫)
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `ruff check` (0 warnings)
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `pytest` (23 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—à–ª–∏)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å coverage (>= 87%)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–æ–≥—Ä–µ—Å—Å —à–∞–≥–∞: 6/6**

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ —à–∞–≥–æ–≤:** 12
- **–í—Å–µ–≥–æ –ø–æ–¥–∑–∞–¥–∞—á:** 44
- **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:** 12 —à–∞–≥–æ–≤ (46 –ø–æ–¥–∑–∞–¥–∞—á) ‚úÖ
- **–í –ø—Ä–æ—Ü–µ—Å—Å–µ:** 0
- **–û—Å—Ç–∞–ª–æ—Å—å:** 0

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π, –∫–æ–≥–¥–∞:

- ‚úÖ YandexGPTProvider –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ —Å–ª–µ–¥—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É GigaChatProvider
- ‚úÖ –í—Å–µ 20+ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ Coverage >= 87%
- ‚úÖ mypy --strict: 0 –æ—à–∏–±–æ–∫
- ‚úÖ ruff check: 0 warnings
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (README, –ø—Ä–∏–º–µ—Ä—ã)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ __init__.py –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (100%)

